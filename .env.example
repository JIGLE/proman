# ===========================================
# PROMAN ENVIRONMENT CONFIGURATION
# ===========================================
# Copy this file to `.env` or `.env.local` for local development
# For production, set these via your deployment platform's environment variables
#
# Required variables are marked with [REQUIRED]
# Optional variables are marked with [OPTIONAL]

# ===========================================
# Core Runtime Configuration
# ===========================================

# [REQUIRED] Application environment
# Values: development, production, test
NODE_ENV=production

# [REQUIRED] Full URL where the app is hosted (no trailing slash)
# Local: http://localhost:3000
# Production: https://your.domain.com
NEXTAUTH_URL=https://your.domain.com

# [OPTIONAL] Secret for signing session tokens (min 32 characters)
# Required when authentication is enabled (`ENABLE_OAUTH=true` or using sessions).
# Generate with: openssl rand -base64 32
NEXTAUTH_SECRET=replace-with-a-secure-secret-min-32-chars

# [OPTIONAL in development, REQUIRED in production] SQLite database connection string
# - Leave unset in development to use mock data (read-only fixtures)
# - Set to use real Prisma database in development for full-stack testing
# Local development: file:./dev.db
# Production (Docker): file:/data/proman.sqlite
# DATABASE_URL=file:/data/proman.sqlite

# ===========================================
# Authentication - Google OAuth (optional)
# ===========================================
# Only required when you opt-in to OAuth by setting `ENABLE_OAUTH=true`.
# Get credentials at: https://console.cloud.google.com/apis/credentials

# [OPTIONAL] Google OAuth Client ID (required if `ENABLE_OAUTH=true`)
GOOGLE_CLIENT_ID=

# [OPTIONAL] Google OAuth Client Secret (required if `ENABLE_OAUTH=true`)
GOOGLE_CLIENT_SECRET=

# ===========================================
# Email Service - SendGrid
# ===========================================
# Required for email notifications (rent reminders, correspondence)
# Get API key at: https://app.sendgrid.com/settings/api_keys

# [OPTIONAL] SendGrid API Key
# Format: SG.xxxxx
SENDGRID_API_KEY=SG.xxx-your-api-key-xxx

# [OPTIONAL] Default "from" email address for outgoing emails
FROM_EMAIL=noreply@proman.app

# [OPTIONAL] SendGrid webhook verification key for delivery tracking
# Get from: https://app.sendgrid.com/settings/mail_settings/webhook
SENDGRID_WEBHOOK_PUBLIC_KEY=

# ===========================================
# Server Binding Configuration
# ===========================================

# [OPTIONAL] Hostname to bind the server to
# Default: 0.0.0.0 (all interfaces)
HOSTNAME=0.0.0.0

# [OPTIONAL] Port to run the server on
# Default: 3000
PORT=3000

# Prestart control flags
# SKIP_PRESTART=true will skip all prestart checks (useful for platforms that manage lifecycle)
SKIP_PRESTART=false
# When true, enforce HOSTNAME/PORT validation during prestart
PRESTART_CHECK_HOSTPORT=false
# When true, prestart will exit with non-zero on sqlite preparation/validation failures
# Default false to allow orchestrators to continue startup when operator will handle DB
PRESTART_FAIL_ON_SQLITE=false

# ===========================================
# Database & Initialization
# ===========================================

# [OPTIONAL] Secret for protecting database initialization endpoints
# Should be strong random string in production
INIT_SECRET=change-me-to-protect-db-init

# [OPTIONAL] Reset database on startup (DANGEROUS - data loss!)
# Only use for development or fresh deployments
RESET_DB=false

# [OPTIONAL] Checksum for database backup verification
DB_BACKUP_CHECKSUM=

# [OPTIONAL] Disable automatic database initialization on app load
# Set to 'true' after initial DB setup to avoid rate limit errors (5 requests/hour limit)
# Manual initialization via scripts/init-db.sh will still work
NEXT_PUBLIC_DISABLE_AUTO_DB_INIT=false

# [OPTIONAL] Control Prisma runtime initialization
# When 'true', the container will run `npx prisma db push && npx prisma generate` at startup.
# Default: false. Prefer using the Helm init Job or manual init for production deployments.
RUN_PRISMA_DB_PUSH_AT_STARTUP=false

# ===========================================

# Debug & Safety Gates
# ===========================================
# IMPORTANT: Keep all of these FALSE in production!

# [OPTIONAL] Allow app to start even if database connection fails
# Only for debugging connection issues
NEXTAUTH_ALLOW_DB_FAILURE=false

# [OPTIONAL] Allow auth system reset (DANGEROUS)
ALLOW_AUTH_RESET=false

# [OPTIONAL] Allow environment variable inspection endpoint
ALLOW_ENV_CHECK=false

# [OPTIONAL] Enable debug logging
# Shows detailed logs in console and structured JSON in production
DEBUG=false

# [OPTIONAL] Minimum log level
# Values: debug, info, warn, error
LOG_LEVEL=info

# [DEV-ONLY] Enable dev fake auth for UI testing (development only)
# Set to 'true' to allow a deterministic fake session during local development.
# WARNING: Do NOT enable in production or commit a .env with this set to true.
NEXT_PUBLIC_DEV_AUTH=false

# ===========================================
# SMTP Fallback (Optional)
# ===========================================
# Unused unless you implement SMTP support instead of SendGrid

SMTP_HOST=
SMTP_PORT=
SMTP_USER=
SMTP_PASS=

# ===========================================
# Payment Integrations (Coming Soon)
# ===========================================
# These are placeholders for future payment gateway integrations
# Currently not implemented - see docs/PAYMENT_INTEGRATIONS.md

# MB WAY (Portugal) - Requires SIBS API Partnership
# Contact: https://www.sibs.com/
# MBWAY_API_KEY=
# MBWAY_MERCHANT_ID=

# Bizum (Spain) - Requires bank partnership
# BIZUM_API_KEY=
# BIZUM_MERCHANT_ID=

# Stripe (International)
# Get keys at: https://dashboard.stripe.com/apikeys
# STRIPE_SECRET_KEY=sk_live_xxx
# STRIPE_PUBLISHABLE_KEY=pk_live_xxx
# STRIPE_WEBHOOK_SECRET=whsec_xxx

# Feature flags to opt-in to optional services (use 'true' to enable)
# When disabled, related integrations will be inactive and won't require secrets.
ENABLE_STRIPE=false
ENABLE_SENDGRID=false
ENABLE_OAUTH=false

# ===========================================
# Monitoring & Analytics (Optional)
# ===========================================
# For production monitoring and error tracking

# ===========================================
# Webhook & Update Notifications (Optional)
# ===========================================

# [OPTIONAL] Secret for verifying incoming webhook requests (HMAC or Bearer)
# Generate with: openssl rand -hex 32
# UPDATE_WEBHOOK_SECRET=

# [OPTIONAL] Require HMAC-only auth (reject Bearer fallback) â€” recommended for production
UPDATE_WEBHOOK_HMAC_ONLY=false

# [OPTIONAL] Explicitly allow Bearer token fallback (not recommended)
ALLOW_BEARER_FALLBACK=false

# [OPTIONAL] Webhook rate limiting
UPDATE_WEBHOOK_RATE_LIMIT=60
UPDATE_WEBHOOK_RATE_WINDOW_MS=60000

# [OPTIONAL] Enable the webhook endpoint (disabled by default)
UPDATE_WEBHOOK_ENABLED=false

# [OPTIONAL] Persistence mount path for latest-release.json cache
# Defaults to /app/data, /data, or process.cwd()
# PERSISTENCE_MOUNT_PATH=/data

# Sentry for error tracking
# Get DSN at: https://sentry.io/
# SENTRY_DSN=

# Analytics (Google Analytics, Plausible, etc.)
# ANALYTICS_ID=

# ===========================================
# Build Metadata
# ===========================================
# Automatically set by CI/CD pipelines

# Application version (from package.json)
BUILD_VERSION=0.0.0

# Git commit hash
GIT_COMMIT=unknown

# Build timestamp (ISO 8601 format)
BUILD_TIME=2026-01-27T00:00:00Z
