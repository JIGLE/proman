import * as React from \"react\"\nimport { ArrowUpDown, ArrowUp, ArrowDown, ChevronLeft, ChevronRight } from \"lucide-react\"\nimport { cn } from \"@/lib/utils\"\nimport { Button } from \"./button\"\nimport { Input } from \"./input\"\n\nexport interface TableColumn<T> {\n  key: keyof T\n  label: string\n  sortable?: boolean\n  width?: string\n  align?: 'left' | 'center' | 'right'\n  render?: (value: any, item: T) => React.ReactNode\n}\n\nexport interface TableProps<T> {\n  data: T[]\n  columns: TableColumn<T>[]\n  loading?: boolean\n  searchable?: boolean\n  searchPlaceholder?: string\n  sortBy?: keyof T\n  sortDirection?: 'asc' | 'desc' | null\n  onSort?: (column: keyof T) => void\n  pagination?: {\n    current: number\n    total: number\n    pageSize: number\n    onPageChange: (page: number) => void\n  }\n  className?: string\n  rowClassName?: (item: T) => string\n  emptyMessage?: string\n  searchValue?: string\n  onSearchChange?: (value: string) => void\n}\n\nexport function EnhancedTable<T extends Record<string, any>>({\n  data,\n  columns,\n  loading = false,\n  searchable = false,\n  searchPlaceholder = \"Search...\",\n  sortBy,\n  sortDirection,\n  onSort,\n  pagination,\n  className,\n  rowClassName,\n  emptyMessage = \"No data available\",\n  searchValue,\n  onSearchChange,\n}: TableProps<T>) {\n  const [internalSearch, setInternalSearch] = React.useState(\"\")\n  const searchTerm = searchValue ?? internalSearch\n  \n  const handleSearchChange = (value: string) => {\n    if (onSearchChange) {\n      onSearchChange(value)\n    } else {\n      setInternalSearch(value)\n    }\n  }\n\n  const getSortIcon = (column: keyof T) => {\n    if (sortBy !== column) {\n      return <ArrowUpDown className=\"h-3 w-3 opacity-50\" />\n    }\n    return sortDirection === 'asc' \n      ? <ArrowUp className=\"h-3 w-3\" />\n      : <ArrowDown className=\"h-3 w-3\" />\n  }\n\n  return (\n    <div className={cn(\"space-y-4\", className)}>\n      {/* Search Bar */}\n      {searchable && (\n        <div className=\"flex items-center gap-4\">\n          <div className=\"flex-1 max-w-sm\">\n            <Input\n              placeholder={searchPlaceholder}\n              value={searchTerm}\n              onChange={(e) => handleSearchChange(e.target.value)}\n              className=\"focus-ring\"\n            />\n          </div>\n        </div>\n      )}\n\n      {/* Table */}\n      <div className=\"surface-elevated rounded-lg border border-[var(--color-border)] overflow-hidden\">\n        <div className=\"overflow-x-auto\">\n          <table className=\"w-full\">\n            {/* Header */}\n            <thead className=\"bg-[var(--color-surface-muted)]\">\n              <tr>\n                {columns.map((column) => (\n                  <th\n                    key={String(column.key)}\n                    className={cn(\n                      \"px-6 py-4 text-left text-xs font-semibold text-zinc-400 uppercase tracking-wider\",\n                      column.width && `w-[${column.width}]`,\n                      column.align === 'center' && \"text-center\",\n                      column.align === 'right' && \"text-right\"\n                    )}\n                  >\n                    {column.sortable && onSort ? (\n                      <button\n                        onClick={() => onSort(column.key)}\n                        className={cn(\n                          \"flex items-center gap-2 hover:text-zinc-200 transition-colors group\",\n                          column.align === 'center' && \"justify-center\",\n                          column.align === 'right' && \"justify-end\"\n                        )}\n                      >\n                        <span>{column.label}</span>\n                        <span className=\"opacity-70 group-hover:opacity-100 transition-opacity\">\n                          {getSortIcon(column.key)}\n                        </span>\n                      </button>\n                    ) : (\n                      column.label\n                    )}\n                  </th>\n                ))}\n              </tr>\n            </thead>\n\n            {/* Body */}\n            <tbody className=\"divide-y divide-[var(--color-border)]\">\n              {loading ? (\n                // Loading skeleton\n                Array.from({ length: 5 }).map((_, index) => (\n                  <tr key={index} className=\"animate-pulse\">\n                    {columns.map((column) => (\n                      <td key={String(column.key)} className=\"px-6 py-4\">\n                        <div className=\"h-4 bg-[var(--color-surface-muted)] rounded\" />\n                      </td>\n                    ))}\n                  </tr>\n                ))\n              ) : data.length === 0 ? (\n                // Empty state\n                <tr>\n                  <td colSpan={columns.length} className=\"px-6 py-12 text-center\">\n                    <div className=\"text-zinc-400\">\n                      <p className=\"text-sm\">{emptyMessage}</p>\n                    </div>\n                  </td>\n                </tr>\n              ) : (\n                // Data rows\n                data.map((item, index) => (\n                  <tr\n                    key={index}\n                    className={cn(\n                      \"hover:bg-[var(--color-surface-hover)] transition-colors group\",\n                      rowClassName?.(item)\n                    )}\n                  >\n                    {columns.map((column) => {\n                      const value = item[column.key]\n                      const content = column.render ? column.render(value, item) : value\n                      \n                      return (\n                        <td\n                          key={String(column.key)}\n                          className={cn(\n                            \"px-6 py-4 text-sm text-zinc-300\",\n                            column.align === 'center' && \"text-center\",\n                            column.align === 'right' && \"text-right\"\n                          )}\n                        >\n                          {content}\n                        </td>\n                      )\n                    })}\n                  </tr>\n                ))\n              )}\n            </tbody>\n          </table>\n        </div>\n\n        {/* Pagination */}\n        {pagination && (\n          <div className=\"border-t border-[var(--color-border)] bg-[var(--color-surface-muted)] px-6 py-4\">\n            <div className=\"flex items-center justify-between\">\n              <div className=\"text-sm text-zinc-400\">\n                Showing {(pagination.current - 1) * pagination.pageSize + 1} to {Math.min(pagination.current * pagination.pageSize, pagination.total)} of {pagination.total} results\n              </div>\n              \n              <div className=\"flex items-center gap-2\">\n                <Button\n                  variant=\"outline\"\n                  size=\"sm\"\n                  onClick={() => pagination.onPageChange(pagination.current - 1)}\n                  disabled={pagination.current <= 1}\n                >\n                  <ChevronLeft className=\"h-4 w-4\" />\n                </Button>\n                \n                <span className=\"text-sm text-zinc-400 px-2\">\n                  Page {pagination.current} of {Math.ceil(pagination.total / pagination.pageSize)}\n                </span>\n                \n                <Button\n                  variant=\"outline\"\n                  size=\"sm\"\n                  onClick={() => pagination.onPageChange(pagination.current + 1)}\n                  disabled={pagination.current >= Math.ceil(pagination.total / pagination.pageSize)}\n                >\n                  <ChevronRight className=\"h-4 w-4\" />\n                </Button>\n              </div>\n            </div>\n          </div>\n        )}\n      </div>\n    </div>\n  )\n}\n