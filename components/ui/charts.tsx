import * as React from \"react\"\nimport { cn } from \"@/lib/utils\"\nimport { TrendingUp, TrendingDown, BarChart3, PieChart, Activity } from \"lucide-react\"\n\ninterface ChartDataPoint {\n  label: string\n  value: number\n  color?: string\n  trend?: number\n}\n\ninterface ChartProps {\n  data: ChartDataPoint[]\n  title?: string\n  subtitle?: string\n  height?: number\n  className?: string\n  showTrend?: boolean\n  showValues?: boolean\n  type?: 'bar' | 'line' | 'pie' | 'area'\n}\n\n// Simple Bar Chart Component\nexport function BarChart({ \n  data, \n  title, \n  subtitle, \n  height = 200, \n  className, \n  showTrend = false,\n  showValues = true \n}: ChartProps) {\n  const maxValue = Math.max(...data.map(d => d.value))\n  const minValue = Math.min(...data.map(d => d.value))\n  const range = maxValue - minValue\n\n  return (\n    <div className={cn(\"space-y-4\", className)}>\n      {(title || subtitle) && (\n        <div className=\"space-y-1\">\n          {title && (\n            <h3 className=\"text-heading-medium font-semibold text-zinc-50 flex items-center gap-2\">\n              <BarChart3 className=\"h-5 w-5 text-accent-primary\" />\n              {title}\n            </h3>\n          )}\n          {subtitle && (\n            <p className=\"text-body-small text-zinc-400\">{subtitle}</p>\n          )}\n        </div>\n      )}\n      \n      <div className=\"space-y-3\">\n        {data.map((item, index) => {\n          const percentage = range > 0 ? ((item.value - minValue) / range) * 100 : 0\n          \n          return (\n            <div key={item.label} className=\"space-y-2\">\n              <div className=\"flex items-center justify-between text-sm\">\n                <span className=\"text-zinc-300 font-medium\">{item.label}</span>\n                <div className=\"flex items-center gap-2\">\n                  {showValues && (\n                    <span className=\"text-zinc-50 font-semibold\">\n                      {typeof item.value === 'number' ? item.value.toLocaleString() : item.value}\n                    </span>\n                  )}\n                  {showTrend && item.trend && (\n                    <div className={cn(\n                      \"flex items-center gap-1 text-xs\",\n                      item.trend > 0 ? \"text-green-400\" : \"text-red-400\"\n                    )}>\n                      {item.trend > 0 ? (\n                        <TrendingUp className=\"h-3 w-3\" />\n                      ) : (\n                        <TrendingDown className=\"h-3 w-3\" />\n                      )}\n                      {Math.abs(item.trend)}%\n                    </div>\n                  )}\n                </div>\n              </div>\n              \n              <div className=\"relative h-2 bg-[var(--color-surface-muted)] rounded-full overflow-hidden\">\n                <div\n                  className={cn(\n                    \"h-full rounded-full transition-all duration-1000 ease-out\",\n                    item.color ? `bg-[${item.color}]` : \"bg-accent-primary\"\n                  )}\n                  style={{ \n                    width: `${Math.max(percentage, 2)}%`,\n                    backgroundColor: item.color || 'var(--color-accent-primary)'\n                  }}\n                />\n              </div>\n            </div>\n          )\n        })}\n      </div>\n    </div>\n  )\n}\n\n// Simple Line Chart Component\nexport function LineChart({ \n  data, \n  title, \n  subtitle, \n  height = 200, \n  className,\n  showValues = false\n}: ChartProps) {\n  const maxValue = Math.max(...data.map(d => d.value))\n  const minValue = Math.min(...data.map(d => d.value))\n  const range = maxValue - minValue || 1\n  const padding = height * 0.1\n  const chartHeight = height - padding * 2\n\n  const points = data.map((item, index) => {\n    const x = (index / (data.length - 1)) * 100\n    const y = ((maxValue - item.value) / range) * 100\n    return { x, y, ...item }\n  })\n\n  const pathData = points\n    .map((point, index) => `${index === 0 ? 'M' : 'L'} ${point.x} ${point.y}`)\n    .join(' ')\n\n  return (\n    <div className={cn(\"space-y-4\", className)}>\n      {(title || subtitle) && (\n        <div className=\"space-y-1\">\n          {title && (\n            <h3 className=\"text-heading-medium font-semibold text-zinc-50 flex items-center gap-2\">\n              <Activity className=\"h-5 w-5 text-accent-primary\" />\n              {title}\n            </h3>\n          )}\n          {subtitle && (\n            <p className=\"text-body-small text-zinc-400\">{subtitle}</p>\n          )}\n        </div>\n      )}\n      \n      <div className=\"relative\" style={{ height }}>\n        <svg\n          width=\"100%\"\n          height=\"100%\"\n          viewBox=\"0 0 100 100\"\n          className=\"overflow-visible\"\n        >\n          {/* Grid Lines */}\n          <defs>\n            <pattern id=\"grid\" width=\"20\" height=\"20\" patternUnits=\"userSpaceOnUse\">\n              <path d=\"M 20 0 L 0 0 0 20\" fill=\"none\" stroke=\"var(--color-border)\" strokeWidth=\"0.5\" opacity=\"0.3\" />\n            </pattern>\n          </defs>\n          <rect width=\"100\" height=\"100\" fill=\"url(#grid)\" />\n          \n          {/* Chart Line */}\n          <path\n            d={pathData}\n            fill=\"none\"\n            stroke=\"var(--color-accent-primary)\"\n            strokeWidth=\"2\"\n            className=\"drop-shadow-sm\"\n          />\n          \n          {/* Data Points */}\n          {points.map((point, index) => (\n            <g key={index}>\n              <circle\n                cx={point.x}\n                cy={point.y}\n                r=\"3\"\n                fill=\"var(--color-accent-primary)\"\n                className=\"drop-shadow-sm hover:r-4 transition-all cursor-pointer\"\n              />\n              {showValues && (\n                <text\n                  x={point.x}\n                  y={point.y - 8}\n                  textAnchor=\"middle\"\n                  className=\"text-xs fill-zinc-300 font-medium\"\n                >\n                  {point.value}\n                </text>\n              )}\n            </g>\n          ))}\n        </svg>\n        \n        {/* X-Axis Labels */}\n        <div className=\"flex justify-between mt-2 px-1\">\n          {data.map((item, index) => (\n            <span key={index} className=\"text-xs text-zinc-400 font-medium\">\n              {item.label}\n            </span>\n          ))}\n        </div>\n      </div>\n    </div>\n  )\n}\n\n// Donut Chart Component\nexport function DonutChart({ \n  data, \n  title, \n  subtitle, \n  height = 200, \n  className \n}: ChartProps) {\n  const total = data.reduce((sum, item) => sum + item.value, 0)\n  const radius = 40\n  const circumference = 2 * Math.PI * radius\n  \n  let accumulatedAngle = 0\n\n  return (\n    <div className={cn(\"space-y-4\", className)}>\n      {(title || subtitle) && (\n        <div className=\"space-y-1\">\n          {title && (\n            <h3 className=\"text-heading-medium font-semibold text-zinc-50 flex items-center gap-2\">\n              <PieChart className=\"h-5 w-5 text-accent-primary\" />\n              {title}\n            </h3>\n          )}\n          {subtitle && (\n            <p className=\"text-body-small text-zinc-400\">{subtitle}</p>\n          )}\n        </div>\n      )}\n      \n      <div className=\"flex items-center gap-6\">\n        {/* Chart */}\n        <div className=\"relative\" style={{ width: height, height }}>\n          <svg width=\"100%\" height=\"100%\" viewBox=\"0 0 100 100\">\n            {data.map((item, index) => {\n              const percentage = (item.value / total) * 100\n              const strokeDasharray = `${percentage * circumference / 100} ${circumference}`\n              const strokeDashoffset = -accumulatedAngle * circumference / 100\n              \n              accumulatedAngle += percentage\n              \n              return (\n                <circle\n                  key={index}\n                  cx=\"50\"\n                  cy=\"50\"\n                  r={radius}\n                  fill=\"transparent\"\n                  stroke={item.color || `hsl(${index * 60}, 60%, 60%)`}\n                  strokeWidth=\"8\"\n                  strokeDasharray={strokeDasharray}\n                  strokeDashoffset={strokeDashoffset}\n                  className=\"transition-all duration-1000 ease-out\"\n                  transform=\"rotate(-90 50 50)\"\n                />\n              )\n            })}\n          </svg>\n          \n          {/* Center Content */}\n          <div className=\"absolute inset-0 flex flex-col items-center justify-center\">\n            <span className=\"text-display-small font-bold text-zinc-50\">\n              {total.toLocaleString()}\n            </span>\n            <span className=\"text-caption text-zinc-400\">Total</span>\n          </div>\n        </div>\n        \n        {/* Legend */}\n        <div className=\"space-y-2 flex-1\">\n          {data.map((item, index) => {\n            const percentage = ((item.value / total) * 100).toFixed(1)\n            \n            return (\n              <div key={index} className=\"flex items-center gap-3\">\n                <div\n                  className=\"w-3 h-3 rounded-full\"\n                  style={{ backgroundColor: item.color || `hsl(${index * 60}, 60%, 60%)` }}\n                />\n                <div className=\"flex-1 flex items-center justify-between\">\n                  <span className=\"text-sm text-zinc-300 font-medium\">{item.label}</span>\n                  <div className=\"text-right\">\n                    <div className=\"text-sm font-semibold text-zinc-50\">\n                      {item.value.toLocaleString()}\n                    </div>\n                    <div className=\"text-xs text-zinc-400\">{percentage}%</div>\n                  </div>\n                </div>\n              </div>\n            )\n          })}\n        </div>\n      </div>\n    </div>\n  )\n}\n\n// Metric Card with Chart\ninterface MetricCardProps {\n  title: string\n  value: string | number\n  change?: number\n  changeLabel?: string\n  icon?: React.ReactNode\n  chart?: React.ReactNode\n  className?: string\n}\n\nexport function MetricCard({\n  title,\n  value,\n  change,\n  changeLabel,\n  icon,\n  chart,\n  className\n}: MetricCardProps) {\n  return (\n    <div className={cn(\n      \"surface-elevated rounded-lg border border-[var(--color-border)] p-6 transition-all duration-200 hover-lift\",\n      className\n    )}>\n      <div className=\"flex items-start justify-between mb-4\">\n        <div className=\"space-y-1\">\n          <p className=\"text-heading-small font-medium text-zinc-400\">{title}</p>\n          <p className=\"text-display-medium font-bold text-zinc-50\">\n            {typeof value === 'number' ? value.toLocaleString() : value}\n          </p>\n        </div>\n        \n        {icon && (\n          <div className=\"p-2 rounded-lg bg-accent-primary/10\">\n            {icon}\n          </div>\n        )}\n      </div>\n      \n      {(change !== undefined || changeLabel) && (\n        <div className=\"flex items-center gap-2 mb-4\">\n          {change !== undefined && (\n            <div className={cn(\n              \"flex items-center gap-1 text-sm font-medium\",\n              change > 0 ? \"text-green-400\" : change < 0 ? \"text-red-400\" : \"text-zinc-400\"\n            )}>\n              {change > 0 && <TrendingUp className=\"h-4 w-4\" />}\n              {change < 0 && <TrendingDown className=\"h-4 w-4\" />}\n              {Math.abs(change)}%\n            </div>\n          )}\n          {changeLabel && (\n            <span className=\"text-sm text-zinc-400\">{changeLabel}</span>\n          )}\n        </div>\n      )}\n      \n      {chart && (\n        <div className=\"mt-4\">\n          {chart}\n        </div>\n      )}\n    </div>\n  )\n}\n